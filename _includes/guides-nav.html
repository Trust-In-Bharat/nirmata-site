<nav class="guides-nav">
  <div class="pillars">
    <a href="{{ '/guides/' | relative_url }}">All Guides</a>
    <a href="{{ '/guides/governance-risk/' | relative_url }}">Governance & Leadership</a>
    <a href="{{ '/guides/asset-data/' | relative_url }}">Asset & Data</a>
    <a href="{{ '/guides/identity-access/' | relative_url }}">Identity & Access</a>
    <a href="{{ '/guides/network-security/' | relative_url }}">Network</a>
    <a href="{{ '/guides/application-security/' | relative_url }}">Application</a>
    <a href="{{ '/guides/endpoint-workload/' | relative_url }}">Endpoint</a>
    <a href="{{ '/guides/sec-ops-monitoring/' | relative_url }}">SecOps</a>
    <a href="{{ '/guides/incident-response/' | relative_url }}">Incident</a>
    <a href="{{ '/guides/privacy-data-protection/' | relative_url }}">Privacy</a>
    <a href="{{ '/guides/compliance-audit/' | relative_url }}">Compliance</a>
    <a href="{{ '/guides/supply-chain/' | relative_url }}">Supply Chain</a>
    <a href="{{ '/guides/awareness-training/' | relative_url }}">Awareness</a>
  </div>

  {%- comment -%}
    Build ordered peer list within the same pillar, only pages that have question_id.
  {%- endcomment -%}
  {% assign peers = site.pages | where:"pillar", page.pillar | where_exp:"p","p.question_id" | sort:"question_id" %}

  {%- assign current_index = -1 -%}
  {%- for p in peers -%}
    {%- if p.url == page.url -%}{%- assign current_index = forloop.index0 -%}{%- endif -%}
  {%- endfor -%}

  {%- assign prev_index = current_index | minus: 1 -%}
  {%- assign next_index = current_index | plus: 1 -%}

  <div class="pager">
    {%- if prev_index >= 0 -%}
      {%- assign prev = peers | slice: prev_index, 1 | first -%}
      <a class="prev" href="{{ prev.url | relative_url }}">← {{ prev.question_id }}</a>
    {%- else -%}
      <span></span>
    {%- endif -%}

    <span class="current">{{ page.pillar }} · {{ page.question_id }}</span>

    {%- if next_index < peers.size -%}
      {%- assign next = peers | slice: next_index, 1 | first -%}
      <a class="next" href="{{ next.url | relative_url }}">{{ next.question_id }} →</a>
    {%- else -%}
      <span></span>
    {%- endif -%}
  </div>
</nav>
